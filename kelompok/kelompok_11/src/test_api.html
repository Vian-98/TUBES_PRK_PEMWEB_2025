<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>API Testing - POS Bengkel UMKM</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      pre {
        background: #1e293b;
        color: #f1f5f9;
        padding: 1rem;
        border-radius: 0.5rem;
        overflow-x: auto;
      }
      .endpoint-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      }
    </style>
  </head>
  <body class="bg-gray-100">
    <div class="container mx-auto px-4 py-8">
      <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
        <h1 class="text-3xl font-bold text-gray-800 mb-2">
          <i class="fas fa-code text-blue-600"></i> API Testing Tool
        </h1>
        <p class="text-gray-600">POS Bengkel UMKM - Transaction API Endpoints</p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        <!-- 1. Summary -->
        <div class="endpoint-card bg-white rounded-lg shadow-md p-6 transition">
          <h3 class="text-xl font-bold text-gray-800 mb-3">
            <i class="fas fa-chart-line text-green-600"></i> Summary
          </h3>
          <p class="text-sm text-gray-600 mb-4">Total transaksi & omzet hari ini</p>
          <button
            onclick="testAPI('summary')"
            class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-2 rounded-lg transition"
          >
            <i class="fas fa-play"></i> Test
          </button>
          <div class="mt-4">
            <p class="text-xs font-mono text-gray-500">GET api_transaksi.php?action=summary</p>
          </div>
        </div>

        <!-- 2. Recent Transactions -->
        <div class="endpoint-card bg-white rounded-lg shadow-md p-6 transition">
          <h3 class="text-xl font-bold text-gray-800 mb-3">
            <i class="fas fa-clock text-blue-600"></i> Recent
          </h3>
          <p class="text-sm text-gray-600 mb-4">10 transaksi terakhir</p>
          <button
            onclick="testAPI('recent', 'limit=10')"
            class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 rounded-lg transition"
          >
            <i class="fas fa-play"></i> Test
          </button>
          <div class="mt-4">
            <p class="text-xs font-mono text-gray-500">
              GET api_transaksi.php?action=recent&limit=10
            </p>
          </div>
        </div>

        <!-- 3. Top Items -->
        <div class="endpoint-card bg-white rounded-lg shadow-md p-6 transition">
          <h3 class="text-xl font-bold text-gray-800 mb-3">
            <i class="fas fa-fire text-red-600"></i> Top Items
          </h3>
          <p class="text-sm text-gray-600 mb-4">Item terlaris (semua waktu)</p>
          <button
            onclick="testAPI('top_items', 'period=all&limit=10')"
            class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-2 rounded-lg transition"
          >
            <i class="fas fa-play"></i> Test
          </button>
          <div class="mt-4">
            <p class="text-xs font-mono text-gray-500">
              GET api_transaksi.php?action=top_items&period=all
            </p>
          </div>
        </div>

        <!-- 4. Monthly Stats -->
        <div class="endpoint-card bg-white rounded-lg shadow-md p-6 transition">
          <h3 class="text-xl font-bold text-gray-800 mb-3">
            <i class="fas fa-calendar-alt text-purple-600"></i> Monthly Stats
          </h3>
          <p class="text-sm text-gray-600 mb-4">Statistik bulanan 2025</p>
          <button
            onclick="testAPI('monthly_stats', 'year=2025')"
            class="w-full bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 rounded-lg transition"
          >
            <i class="fas fa-play"></i> Test
          </button>
          <div class="mt-4">
            <p class="text-xs font-mono text-gray-500">
              GET api_transaksi.php?action=monthly_stats&year=2025
            </p>
          </div>
        </div>

        <!-- 5. Payment Methods -->
        <div class="endpoint-card bg-white rounded-lg shadow-md p-6 transition">
          <h3 class="text-xl font-bold text-gray-800 mb-3">
            <i class="fas fa-credit-card text-yellow-600"></i> Payment Methods
          </h3>
          <p class="text-sm text-gray-600 mb-4">Metode pembayaran (semua)</p>
          <button
            onclick="testAPI('payment_methods', 'period=all')"
            class="w-full bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-2 rounded-lg transition"
          >
            <i class="fas fa-play"></i> Test
          </button>
          <div class="mt-4">
            <p class="text-xs font-mono text-gray-500">
              GET api_transaksi.php?action=payment_methods
            </p>
          </div>
        </div>

        <!-- 6. Detail Transaction -->
        <div class="endpoint-card bg-white rounded-lg shadow-md p-6 transition">
          <h3 class="text-xl font-bold text-gray-800 mb-3">
            <i class="fas fa-file-invoice text-indigo-600"></i> Detail
          </h3>
          <p class="text-sm text-gray-600 mb-4">Detail transaksi ID #1</p>
          <button
            onclick="testAPI('detail', 'id=1')"
            class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 rounded-lg transition"
          >
            <i class="fas fa-play"></i> Test
          </button>
          <div class="mt-4">
            <p class="text-xs font-mono text-gray-500">GET api_transaksi.php?action=detail&id=1</p>
          </div>
        </div>
      </div>

      <!-- Response Area -->
      <div class="mt-8 bg-white rounded-lg shadow-lg p-6">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-2xl font-bold text-gray-800">
            <i class="fas fa-terminal text-green-600"></i> Response
          </h2>
          <button
            onclick="clearResponse()"
            class="bg-gray-400 hover:bg-gray-500 text-white px-4 py-2 rounded-lg transition"
          >
            <i class="fas fa-eraser"></i> Clear
          </button>
        </div>

        <div id="loading" class="hidden text-center py-8">
          <i class="fas fa-spinner fa-spin text-4xl text-blue-600"></i>
          <p class="text-gray-600 mt-4">Loading...</p>
        </div>

        <div id="response" class="hidden">
          <div class="mb-4">
            <span class="text-sm font-semibold text-gray-700">Status: </span>
            <span id="statusBadge" class="px-3 py-1 rounded-full text-sm font-bold"></span>
          </div>
          <div class="mb-2">
            <span class="text-sm font-semibold text-gray-700">URL: </span>
            <code id="requestUrl" class="text-sm text-blue-600"></code>
          </div>
          <div class="mb-2">
            <span class="text-sm font-semibold text-gray-700">Response Time: </span>
            <span id="responseTime" class="text-sm text-gray-600"></span>
          </div>
          <pre id="jsonResponse" class="mt-4"></pre>
        </div>

        <div id="emptyState" class="text-center py-12 text-gray-400">
          <i class="fas fa-code text-6xl mb-4"></i>
          <p>Pilih endpoint di atas untuk testing API</p>
        </div>
      </div>

      <!-- Info -->
      <div class="mt-6 bg-blue-50 border border-blue-200 rounded-lg p-6">
        <h3 class="text-lg font-bold text-blue-800 mb-2">
          <i class="fas fa-info-circle"></i> Informasi
        </h3>
        <ul class="text-sm text-blue-700 space-y-1">
          <li>• Pastikan sudah import <code>sample_data.sql</code> untuk data testing</li>
          <li>• API menggunakan metode <strong>GET</strong> untuk semua endpoint</li>
          <li>• Response format: <strong>JSON</strong></li>
          <li>• Base URL: <code>/pos/api_transaksi.php</code></li>
        </ul>
      </div>
    </div>

    <script>
      let startTime;

      async function testAPI(action, params = '') {
        // Show loading
        document.getElementById('emptyState').classList.add('hidden');
        document.getElementById('response').classList.add('hidden');
        document.getElementById('loading').classList.remove('hidden');

        // Build URL
        const baseUrl = 'pos/api_transaksi.php';
        const url = params
          ? `${baseUrl}?action=${action}&${params}`
          : `${baseUrl}?action=${action}`;

        // Start timer
        startTime = performance.now();

        try {
          const response = await fetch(url);
          const data = await response.json();

          // Calculate response time
          const endTime = performance.now();
          const responseTime = (endTime - startTime).toFixed(2);

          // Hide loading
          document.getElementById('loading').classList.add('hidden');
          document.getElementById('response').classList.remove('hidden');

          // Update status badge
          const statusBadge = document.getElementById('statusBadge');
          if (data.status === 'success') {
            statusBadge.className =
              'px-3 py-1 rounded-full text-sm font-bold bg-green-100 text-green-800';
            statusBadge.textContent = '✓ Success';
          } else {
            statusBadge.className =
              'px-3 py-1 rounded-full text-sm font-bold bg-red-100 text-red-800';
            statusBadge.textContent = '✗ Error';
          }

          // Update URL
          document.getElementById('requestUrl').textContent = url;

          // Update response time
          document.getElementById('responseTime').textContent = `${responseTime} ms`;

          // Update JSON response
          document.getElementById('jsonResponse').textContent = JSON.stringify(data, null, 2);
        } catch (error) {
          document.getElementById('loading').classList.add('hidden');
          document.getElementById('response').classList.remove('hidden');

          const statusBadge = document.getElementById('statusBadge');
          statusBadge.className =
            'px-3 py-1 rounded-full text-sm font-bold bg-red-100 text-red-800';
          statusBadge.textContent = '✗ Error';

          document.getElementById('jsonResponse').textContent = 'Error: ' + error.message;
        }
      }

      function clearResponse() {
        document.getElementById('response').classList.add('hidden');
        document.getElementById('emptyState').classList.remove('hidden');
      }
    </script>
  </body>
</html>
